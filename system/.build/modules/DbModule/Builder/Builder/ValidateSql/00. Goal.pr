{
  "GoalName": "ValidateSql",
  "Comment": null,
  "Version": 1,
  "GoalSteps": [
    {
      "Text": "set %databaseType% = \"SQLite\"",
      "Comment": "Second LLM call - validate SQL with focused schema context",
      "ModuleType": "PLang.Modules.VariableModule",
      "Name": "set_database_type_variable",
      "Description": "Assign the string 'SQLite' to the variable named %databaseType%, updating or creating this variable in the current context",
      "PrFileName": "01. set_database_type_variable.pr",
      "RelativePrPath": ".build\\modules\\DbModule\\Builder\\Builder\\ValidateSql\\01. set_database_type_variable.pr",
      "InstructionHash": null,
      "Indent": 0,
      "Execute": true,
      "RunOnce": false,
      "Confidence": null,
      "Inconsistency": null,
      "Generated": "2025-12-15T13:43:22.6016435+00:00",
      "WaitForExecution": true,
      "LoggerLevel": null,
      "ErrorHandlers": null,
      "Retry": false,
      "RetryCount": 1,
      "CacheHandler": null,
      "CancellationHandler": null,
      "Number": 0,
      "LineNumber": 65,
      "EventBinding": null,
      "IsEvent": false,
      "Hash": "da5ace6fc765fcfd88ea70f685fe8a9d3c5f47e8e824cad5150f5de4e350bcbb",
      "BuilderVersion": null,
      "RelativeGoalPath": "\\modules\\DbModule\\Builder\\Builder.goal",
      "UserIntent": null
    },
    {
      "Text": "if %currentDataSources% is not empty then",
      "Comment": null,
      "ModuleType": "PLang.Modules.ConditionalModule",
      "Name": "check_currentdatasources_not_empty",
      "Description": "Evaluate whether the variable %currentDataSources% is not empty. If it contains data, the condition evaluates to true and subsequent steps depending on this condition can proceed accordingly.",
      "PrFileName": "02. check_currentdatasources_not_empty.pr",
      "RelativePrPath": ".build\\modules\\DbModule\\Builder\\Builder\\ValidateSql\\02. check_currentdatasources_not_empty.pr",
      "InstructionHash": null,
      "Indent": 0,
      "Execute": true,
      "RunOnce": false,
      "Confidence": null,
      "Inconsistency": null,
      "Generated": "2025-12-15T13:43:22.6684838+00:00",
      "WaitForExecution": true,
      "LoggerLevel": null,
      "ErrorHandlers": null,
      "Retry": false,
      "RetryCount": 1,
      "CacheHandler": null,
      "CancellationHandler": null,
      "Number": 1,
      "LineNumber": 66,
      "EventBinding": null,
      "IsEvent": false,
      "Hash": "93fc7bb1dc031981c6ea4eebc11824277eefd99a787daf41f3d5d06be6905549",
      "BuilderVersion": null,
      "RelativeGoalPath": "\\modules\\DbModule\\Builder\\Builder.goal",
      "UserIntent": null
    },
    {
      "Text": "set %databaseType% = %currentDataSources[0].TypeFullName%",
      "Comment": null,
      "ModuleType": "PLang.Modules.VariableModule",
      "Name": "set_database_type_from_datasource",
      "Description": "Retrieve the TypeFullName property of the first element in the currentDataSources list and assign it to the variable %databaseType%. This is a straightforward variable assignment operation.",
      "PrFileName": "03. set_database_type_from_datasource.pr",
      "RelativePrPath": ".build\\modules\\DbModule\\Builder\\Builder\\ValidateSql\\03. set_database_type_from_datasource.pr",
      "InstructionHash": null,
      "Indent": 4,
      "Execute": false,
      "RunOnce": false,
      "Confidence": null,
      "Inconsistency": null,
      "Generated": "2025-12-15T13:43:22.7259386+00:00",
      "WaitForExecution": true,
      "LoggerLevel": null,
      "ErrorHandlers": null,
      "Retry": false,
      "RetryCount": 1,
      "CacheHandler": null,
      "CancellationHandler": null,
      "Number": 2,
      "LineNumber": 67,
      "EventBinding": null,
      "IsEvent": false,
      "Hash": "9c571c66878ee0ca14e5546d792ac7c877e0de7bc45b48302b6f8df73317634a",
      "BuilderVersion": null,
      "RelativeGoalPath": "\\modules\\DbModule\\Builder\\Builder.goal",
      "UserIntent": null
    },
    {
      "Text": "render template \"llm/validateSql.llm\", write to %validatePrompt%",
      "Comment": null,
      "ModuleType": "PLang.Modules.TemplateEngineModule",
      "Name": "render_template_to_variable",
      "Description": "Load the template file 'llm/validateSql.llm', process it through the template engine to generate the final content, and then write this rendered content into the variable %validatePrompt% for further use.",
      "PrFileName": "04. render_template_to_variable.pr",
      "RelativePrPath": ".build\\modules\\DbModule\\Builder\\Builder\\ValidateSql\\04. render_template_to_variable.pr",
      "InstructionHash": null,
      "Indent": 0,
      "Execute": true,
      "RunOnce": false,
      "Confidence": null,
      "Inconsistency": null,
      "Generated": "2025-12-15T13:45:35.0435517+00:00",
      "WaitForExecution": true,
      "LoggerLevel": null,
      "ErrorHandlers": null,
      "Retry": false,
      "RetryCount": 1,
      "CacheHandler": null,
      "CancellationHandler": null,
      "Number": 3,
      "LineNumber": 68,
      "EventBinding": null,
      "IsEvent": false,
      "Hash": "29f8dc569d4b231d669a8d12dfde8618cc136da056919cebd66fc2f9684a948b",
      "BuilderVersion": null,
      "RelativeGoalPath": "\\modules\\DbModule\\Builder\\Builder.goal",
      "UserIntent": null
    },
    {
      "Text": "[llm] system: %validatePrompt%\n    user: %step.Text%\n    scheme: {\n        \"hasSql\": \"bool\",\n        \"originalSql\": \"string\",\n        \"validatedSql\": \"string\",\n        \"sqlComments\": [{\"Text\": \"string\", \"Level\": \"Info|Warning|Error|Improvement|Inconsistency\"}]\n    }\n    write to %sqlValidation%",
      "Comment": null,
      "ModuleType": "PLang.Modules.LlmModule",
      "Name": "validate_sql_with_llm",
      "Description": "Send the SQL validation prompt stored in %validatePrompt% and the SQL query text in %step.Text% to a language model. The model is expected to return a JSON object indicating whether the text contains SQL, the original SQL, a validated version of the SQL, and an array of comments with text and severity levels. The result is stored in %sqlValidation%.",
      "PrFileName": "05. validate_sql_with_llm.pr",
      "RelativePrPath": ".build\\modules\\DbModule\\Builder\\Builder\\ValidateSql\\05. validate_sql_with_llm.pr",
      "InstructionHash": null,
      "Indent": 0,
      "Execute": true,
      "RunOnce": false,
      "Confidence": null,
      "Inconsistency": null,
      "Generated": "2025-12-15T13:49:55.4421938+00:00",
      "WaitForExecution": true,
      "LoggerLevel": null,
      "ErrorHandlers": null,
      "Retry": false,
      "RetryCount": 1,
      "CacheHandler": null,
      "CancellationHandler": null,
      "Number": 4,
      "LineNumber": 69,
      "EventBinding": null,
      "IsEvent": false,
      "Hash": "06125b7e3eefdd579d3b21e9ba55aa4dcab2cafd1034d0eb68966e83635eb072",
      "BuilderVersion": null,
      "RelativeGoalPath": "\\modules\\DbModule\\Builder\\Builder.goal",
      "UserIntent": null
    },
    {
      "Text": "append %sqlValidation!llm% to %step.llm%",
      "Comment": null,
      "ModuleType": "PLang.Modules.VariableModule",
      "Name": "append_sqlvalidationllm_to_stepllm",
      "Description": "Take the value stored in the variable %sqlValidation!llm% and append it to the existing value of the variable %step.llm%, effectively concatenating the two variable contents.",
      "PrFileName": "06. append_sqlvalidationllm_to_stepllm.pr",
      "RelativePrPath": ".build\\modules\\DbModule\\Builder\\Builder\\ValidateSql\\06. append_sqlvalidationllm_to_stepllm.pr",
      "InstructionHash": null,
      "Indent": 0,
      "Execute": true,
      "RunOnce": false,
      "Confidence": null,
      "Inconsistency": null,
      "Generated": "2025-12-15T15:21:30.8807994+00:00",
      "WaitForExecution": true,
      "LoggerLevel": null,
      "ErrorHandlers": null,
      "Retry": false,
      "RetryCount": 1,
      "CacheHandler": null,
      "CancellationHandler": null,
      "Number": 5,
      "LineNumber": 78,
      "EventBinding": null,
      "IsEvent": false,
      "Hash": "0b5c2308ce34daeec4ecf4228af36306c6c3ab106c44345c0ef8351134839063",
      "BuilderVersion": null,
      "RelativeGoalPath": "\\modules\\DbModule\\Builder\\Builder.goal",
      "UserIntent": null
    },
    {
      "Text": "if %sqlValidation.sqlComments% is not empty then",
      "Comment": null,
      "ModuleType": "PLang.Modules.ConditionalModule",
      "Name": "check_sqlcomments_not_empty",
      "Description": "Evaluate whether the variable %sqlValidation.sqlComments% has any content (is not empty). If it contains data, the condition evaluates to true and subsequent steps depending on this condition can be executed.",
      "PrFileName": "07. check_sqlcomments_not_empty.pr",
      "RelativePrPath": ".build\\modules\\DbModule\\Builder\\Builder\\ValidateSql\\07. check_sqlcomments_not_empty.pr",
      "InstructionHash": null,
      "Indent": 0,
      "Execute": true,
      "RunOnce": false,
      "Confidence": null,
      "Inconsistency": null,
      "Generated": "2025-12-15T15:21:36.5595664+00:00",
      "WaitForExecution": true,
      "LoggerLevel": null,
      "ErrorHandlers": null,
      "Retry": false,
      "RetryCount": 1,
      "CacheHandler": null,
      "CancellationHandler": null,
      "Number": 6,
      "LineNumber": 79,
      "EventBinding": null,
      "IsEvent": false,
      "Hash": "82513a26c4735cc5d9254ea54e0ccb405c5e36910490c50076de7ce961c5f781",
      "BuilderVersion": null,
      "RelativeGoalPath": "\\modules\\DbModule\\Builder\\Builder.goal",
      "UserIntent": null
    },
    {
      "Text": "append %sqlValidation.sqlComments% to %step.LlmComments%",
      "Comment": null,
      "ModuleType": "PLang.Modules.VariableModule",
      "Name": "append_sqlcomments_to_llmcomments",
      "Description": "Take the value stored in the variable %sqlValidation.sqlComments% and append it to the current value of the variable %step.LlmComments%, effectively concatenating the two strings and updating %step.LlmComments% with the combined result.",
      "PrFileName": "08. append_sqlcomments_to_llmcomments.pr",
      "RelativePrPath": ".build\\modules\\DbModule\\Builder\\Builder\\ValidateSql\\08. append_sqlcomments_to_llmcomments.pr",
      "InstructionHash": null,
      "Indent": 4,
      "Execute": false,
      "RunOnce": false,
      "Confidence": null,
      "Inconsistency": null,
      "Generated": "2025-12-15T15:21:48.0935114+00:00",
      "WaitForExecution": true,
      "LoggerLevel": null,
      "ErrorHandlers": null,
      "Retry": false,
      "RetryCount": 1,
      "CacheHandler": null,
      "CancellationHandler": null,
      "Number": 7,
      "LineNumber": 80,
      "EventBinding": null,
      "IsEvent": false,
      "Hash": "1d304ca19e5063120e93e3ae0be3e8691bf1b3c8acca6be06815ba0ed536d11e",
      "BuilderVersion": null,
      "RelativeGoalPath": "\\modules\\DbModule\\Builder\\Builder.goal",
      "UserIntent": null
    },
    {
      "Text": "if %sqlValidation.validatedSql% is not empty then",
      "Comment": null,
      "ModuleType": "PLang.Modules.ConditionalModule",
      "Name": "check_sqlvalidation_validatedsql_not_empty",
      "Description": "Evaluate whether the variable %sqlValidation.validatedSql% is not empty. If this condition is true, then proceed with the steps inside the conditional block; otherwise, skip or execute alternative steps if defined",
      "PrFileName": "09. check_sqlvalidation_validatedsql_not_empty.pr",
      "RelativePrPath": ".build\\modules\\DbModule\\Builder\\Builder\\ValidateSql\\09. check_sqlvalidation_validatedsql_not_empty.pr",
      "InstructionHash": null,
      "Indent": 0,
      "Execute": true,
      "RunOnce": false,
      "Confidence": null,
      "Inconsistency": null,
      "Generated": "2025-12-15T15:24:38.9752061+00:00",
      "WaitForExecution": true,
      "LoggerLevel": null,
      "ErrorHandlers": null,
      "Retry": false,
      "RetryCount": 1,
      "CacheHandler": null,
      "CancellationHandler": null,
      "Number": 8,
      "LineNumber": 81,
      "EventBinding": null,
      "IsEvent": false,
      "Hash": "446da9f59e225d7f3937c1f44bfebb38f624d3bc814208f1caa0919143cf718f",
      "BuilderVersion": null,
      "RelativeGoalPath": "\\modules\\DbModule\\Builder\\Builder.goal",
      "UserIntent": null
    },
    {
      "Text": "set %validatedSql% = %sqlValidation.validatedSql%",
      "Comment": null,
      "ModuleType": "PLang.Modules.VariableModule",
      "Name": "assign_validated_sql_variable",
      "Description": "Copy the content of the variable %sqlValidation.validatedSql% into the variable %validatedSql%, effectively updating or initializing %validatedSql% with the validated SQL string or object.",
      "PrFileName": "10. assign_validated_sql_variable.pr",
      "RelativePrPath": ".build\\modules\\DbModule\\Builder\\Builder\\ValidateSql\\10. assign_validated_sql_variable.pr",
      "InstructionHash": null,
      "Indent": 4,
      "Execute": false,
      "RunOnce": false,
      "Confidence": null,
      "Inconsistency": null,
      "Generated": "2025-12-15T15:21:58.864247+00:00",
      "WaitForExecution": true,
      "LoggerLevel": null,
      "ErrorHandlers": null,
      "Retry": false,
      "RetryCount": 1,
      "CacheHandler": null,
      "CancellationHandler": null,
      "Number": 9,
      "LineNumber": 82,
      "EventBinding": null,
      "IsEvent": false,
      "Hash": "27ea80f5b48a9b00e5de3bae1f634299782e05f63ef07e29a5077a4f288d89f1",
      "BuilderVersion": null,
      "RelativeGoalPath": "\\modules\\DbModule\\Builder\\Builder.goal",
      "UserIntent": null
    }
  ],
  "SubGoals": [],
  "Description": "The ValidateSql goal validates SQL statements based on the provided schema context. It begins by setting a default database type to 'SQLite'. If there are current data sources available, it updates the database type to the type of the first data source. It then renders a validation template and processes the SQL validation results, appending comments and validated SQL to the step's properties as necessary.",
  "Visibility": 0,
  "GoalFileName": "Builder.goal",
  "PrFileName": "00. Goal.pr",
  "PrPath": ".build\\modules\\DbModule\\Builder\\Builder\\ValidateSql\\00. Goal.pr",
  "RelativeGoalPath": "\\modules\\DbModule\\Builder\\Builder.goal",
  "RelativeGoalFolderPath": "\\modules\\DbModule\\Builder",
  "RelativePrPath": ".build\\modules\\DbModule\\Builder\\Builder\\ValidateSql\\00. Goal.pr",
  "RelativePrFolderPath": ".build\\modules\\DbModule\\Builder\\Builder\\ValidateSql",
  "RelativeAppStartupFolderPath": null,
  "BuilderVersion": "1.0.0.0",
  "GoalInfo": null,
  "Injections": [],
  "Signature": null,
  "Hash": "d1669fde89a9c0bda7fced6c602000083c37da8fe36885e2caaaf014c6cd9bea",
  "IncomingVariablesRequired": {
    "%currentDataSources%": "A list of current data sources that may contain information about the database type.",
    "%step.Text%": "The SQL statement that needs to be validated."
  },
  "DataSourceName": null,
  "IsSetup": false,
  "IsEvent": false,
  "IsStart": false
}