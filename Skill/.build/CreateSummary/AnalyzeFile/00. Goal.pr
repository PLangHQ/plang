{
  "GoalName": "AnalyzeFile",
  "Comment": null,
  "GoalSteps": [
    {
      "Text": "read %file.path%, write to %content%",
      "Comment": null,
      "ModuleType": "PLang.Modules.FileModule",
      "Name": "read_file_to_variable",
      "Description": "Access the file system to read the file located at the path stored in %file.path% and write the entire content of that file into the variable %content% for further use",
      "PrFileName": "01. read_file_to_variable.pr",
      "RelativePrPath": ".build\\CreateSummary\\AnalyzeFile\\01. read_file_to_variable.pr",
      "InstructionHash": null,
      "Indent": 0,
      "Execute": true,
      "RunOnce": false,
      "Confidence": null,
      "Inconsistency": null,
      "Generated": "2025-12-09T13:39:51.1830708+00:00",
      "WaitForExecution": true,
      "LoggerLevel": null,
      "ErrorHandlers": null,
      "Retry": false,
      "RetryCount": 1,
      "CacheHandler": null,
      "CancellationHandler": null,
      "Number": 0,
      "LineNumber": 6,
      "EventBinding": null,
      "IsEvent": false,
      "Hash": "4c5fc015f637c8ea42b3b2a5ed82bba79f5699d9aadea5504d88fd500e6380ed",
      "BuilderVersion": null,
      "RelativeGoalPath": "\\CreateSummary.goal",
      "UserIntent": null
    },
    {
      "Text": "hash %content%, write to %file.Hash%",
      "Comment": null,
      "ModuleType": "PLang.Modules.CryptographicModule",
      "Name": "hash_content_to_file_hash",
      "Description": "Take the data stored in the %content% variable, compute its hash using a cryptographic hash function, and then store the resulting hash value into the %file.Hash% variable for later use or verification.",
      "PrFileName": "02. hash_content_to_file_hash.pr",
      "RelativePrPath": ".build\\CreateSummary\\AnalyzeFile\\02. hash_content_to_file_hash.pr",
      "InstructionHash": null,
      "Indent": 0,
      "Execute": true,
      "RunOnce": false,
      "Confidence": null,
      "Inconsistency": null,
      "Generated": "2025-12-09T13:39:58.4655817+00:00",
      "WaitForExecution": true,
      "LoggerLevel": null,
      "ErrorHandlers": null,
      "Retry": false,
      "RetryCount": 1,
      "CacheHandler": null,
      "CancellationHandler": null,
      "Number": 1,
      "LineNumber": 7,
      "EventBinding": null,
      "IsEvent": false,
      "Hash": "ce93dbf995a58aece67bddcfaae0bc99a6449757d21966e1660f58eb70583ae5",
      "BuilderVersion": null,
      "RelativeGoalPath": "\\CreateSummary.goal",
      "UserIntent": null
    },
    {
      "Text": "select count(*) as %count% from files where path=%file.path% and hash=%file.hash%, ds: 'data', return 1",
      "Comment": null,
      "ModuleType": "PLang.Modules.DbModule",
      "Name": "select_count_from_files_by_path_and_hash",
      "Description": "Execute a SQL query on the 'files' table in the 'data' datasource to count how many records have a 'path' equal to the value in %file.path% and a 'hash' equal to the value in %file.hash%. Store the resulting count in the variable %count%. Limit the result to one row.",
      "PrFileName": "03. select_count_from_files_by_path_and_hash.pr",
      "RelativePrPath": ".build\\CreateSummary\\AnalyzeFile\\03. select_count_from_files_by_path_and_hash.pr",
      "InstructionHash": null,
      "Indent": 0,
      "Execute": true,
      "RunOnce": false,
      "Confidence": null,
      "Inconsistency": null,
      "Generated": "2025-12-09T13:39:58.580703+00:00",
      "WaitForExecution": true,
      "LoggerLevel": null,
      "ErrorHandlers": null,
      "Retry": false,
      "RetryCount": 1,
      "CacheHandler": null,
      "CancellationHandler": null,
      "Number": 2,
      "LineNumber": 8,
      "EventBinding": null,
      "IsEvent": false,
      "Hash": "26990d4b008691a44f33c00a8ae930ed7fc5b6e5bee183c4813b76c988c7797d",
      "BuilderVersion": null,
      "RelativeGoalPath": "\\CreateSummary.goal",
      "UserIntent": null
    },
    {
      "Text": "if %count% is 1 then",
      "Comment": null,
      "ModuleType": "PLang.Modules.ConditionalModule",
      "Name": "if_count_is_1",
      "Description": "Evaluate whether the variable %count% has the value 1, and if so, execute the subsequent steps or logic defined within this conditional branch",
      "PrFileName": "04. if_count_is_1.pr",
      "RelativePrPath": ".build\\CreateSummary\\AnalyzeFile\\04. if_count_is_1.pr",
      "InstructionHash": null,
      "Indent": 0,
      "Execute": true,
      "RunOnce": false,
      "Confidence": null,
      "Inconsistency": null,
      "Generated": "2025-12-09T13:39:58.6590731+00:00",
      "WaitForExecution": true,
      "LoggerLevel": null,
      "ErrorHandlers": null,
      "Retry": false,
      "RetryCount": 1,
      "CacheHandler": null,
      "CancellationHandler": null,
      "Number": 3,
      "LineNumber": 9,
      "EventBinding": null,
      "IsEvent": false,
      "Hash": "af493e5d71f8ba5f774a6f8c4dbb1b19ace37d8e32ffe2c4623da54dfbb617bd",
      "BuilderVersion": null,
      "RelativeGoalPath": "\\CreateSummary.goal",
      "UserIntent": null
    },
    {
      "Text": "end goal",
      "Comment": null,
      "ModuleType": "PLang.Modules.ThrowErrorModule",
      "Name": "end_goal",
      "Description": "This step instructs the system to immediately stop the execution of the current goal, effectively ending the process or workflow that is currently running.",
      "PrFileName": "05. end_goal.pr",
      "RelativePrPath": ".build\\CreateSummary\\AnalyzeFile\\05. end_goal.pr",
      "InstructionHash": null,
      "Indent": 4,
      "Execute": false,
      "RunOnce": false,
      "Confidence": null,
      "Inconsistency": null,
      "Generated": "2025-12-09T13:39:58.7173764+00:00",
      "WaitForExecution": true,
      "LoggerLevel": null,
      "ErrorHandlers": null,
      "Retry": false,
      "RetryCount": 1,
      "CacheHandler": null,
      "CancellationHandler": null,
      "Number": 4,
      "LineNumber": 10,
      "EventBinding": null,
      "IsEvent": false,
      "Hash": "9bb6b1a85b90f9dfddd8ecd00f6222c42ef0fa0e9b29da5fdc72a9a65718c660",
      "BuilderVersion": null,
      "RelativeGoalPath": "\\CreateSummary.goal",
      "UserIntent": null
    },
    {
      "Text": "read system.llm, write to %system%",
      "Comment": null,
      "ModuleType": "PLang.Modules.FileModule",
      "Name": "read_system_llm_write_to_system_variable",
      "Description": "Access the file named system.llm, read its content, and then write that content into the variable named %system% for further use.",
      "PrFileName": "06. read_system_llm_write_to_system_variable.pr",
      "RelativePrPath": ".build\\CreateSummary\\AnalyzeFile\\06. read_system_llm_write_to_system_variable.pr",
      "InstructionHash": null,
      "Indent": 0,
      "Execute": true,
      "RunOnce": false,
      "Confidence": null,
      "Inconsistency": null,
      "Generated": "2025-12-09T13:39:58.8403954+00:00",
      "WaitForExecution": true,
      "LoggerLevel": null,
      "ErrorHandlers": null,
      "Retry": false,
      "RetryCount": 1,
      "CacheHandler": null,
      "CancellationHandler": null,
      "Number": 5,
      "LineNumber": 11,
      "EventBinding": null,
      "IsEvent": false,
      "Hash": "97459d75f63bc73e3a4c27f56bebf9ab7033e62fe8a23ab8ef041d02df65435a",
      "BuilderVersion": null,
      "RelativeGoalPath": "\\CreateSummary.goal",
      "UserIntent": null
    },
    {
      "Text": "[llm] system:%system%\n    user: %content%\n    scheme: {title:string, summary:string}\n    write to %response%",
      "Comment": null,
      "ModuleType": "PLang.Modules.LlmModule",
      "Name": "llm_process_with_system_and_user_prompts",
      "Description": "Send the content of the %content% variable to a language model with the system prompt from %system%, expecting a response structured as a JSON object with title and summary fields, and store the output in %response%",
      "PrFileName": "07. llm_process_with_system_and_user_prompts.pr",
      "RelativePrPath": ".build\\CreateSummary\\AnalyzeFile\\07. llm_process_with_system_and_user_prompts.pr",
      "InstructionHash": null,
      "Indent": 0,
      "Execute": true,
      "RunOnce": false,
      "Confidence": null,
      "Inconsistency": null,
      "Generated": "2025-12-09T13:58:48.0227447+00:00",
      "WaitForExecution": true,
      "LoggerLevel": null,
      "ErrorHandlers": null,
      "Retry": false,
      "RetryCount": 1,
      "CacheHandler": null,
      "CancellationHandler": null,
      "Number": 6,
      "LineNumber": 12,
      "EventBinding": null,
      "IsEvent": false,
      "Hash": "43a57c88c7c15583b7dc4179fa05757d7adfee6e498cdc6b97d6965ab6a410c4",
      "BuilderVersion": null,
      "RelativeGoalPath": "\\CreateSummary.goal",
      "UserIntent": null
    },
    {
      "Text": "upsert files path=%file.Path%(unique), title=%file.title%, hash=%file.Hash%, updated=%now%",
      "Comment": null,
      "ModuleType": "PLang.Modules.DbModule",
      "Name": "upsert_file_record_by_path",
      "Description": "Perform an upsert (insert or update) operation on the files table or collection, using the file path as a unique key. The fields to be set or updated include path, title, hash, and updated timestamp with the current time value.",
      "PrFileName": "08. upsert_file_record_by_path.pr",
      "RelativePrPath": ".build\\CreateSummary\\AnalyzeFile\\08. upsert_file_record_by_path.pr",
      "InstructionHash": null,
      "Indent": 0,
      "Execute": true,
      "RunOnce": false,
      "Confidence": null,
      "Inconsistency": null,
      "Generated": "2025-12-09T13:59:13.1796109+00:00",
      "WaitForExecution": true,
      "LoggerLevel": null,
      "ErrorHandlers": null,
      "Retry": false,
      "RetryCount": 1,
      "CacheHandler": null,
      "CancellationHandler": null,
      "Number": 7,
      "LineNumber": 16,
      "EventBinding": null,
      "IsEvent": false,
      "Hash": "f205c99a82b939e637cb237d11584b75c1c98010222d5c18be6448312c160092",
      "BuilderVersion": null,
      "RelativeGoalPath": "\\CreateSummary.goal",
      "UserIntent": null
    },
    {
      "Text": "write \"## %response.title%\\n\\n%response.summary%\" to /summaries/%file.Name%",
      "Comment": null,
      "ModuleType": "PLang.Modules.FileModule",
      "Name": "write_summary_to_file",
      "Description": "Create a string that starts with '## ' followed by the value of the variable %response.title%, then two new lines, then the value of %response.summary%. Write this string content to a file located at the path /summaries/%file.Name%, where %file.Name% is a variable representing the file name.",
      "PrFileName": "09. write_summary_to_file.pr",
      "RelativePrPath": ".build\\CreateSummary\\AnalyzeFile\\09. write_summary_to_file.pr",
      "InstructionHash": null,
      "Indent": 0,
      "Execute": true,
      "RunOnce": false,
      "Confidence": "Very High",
      "Inconsistency": null,
      "Generated": "2025-12-09T14:00:31.2671623+00:00",
      "WaitForExecution": true,
      "LoggerLevel": null,
      "ErrorHandlers": null,
      "Retry": false,
      "RetryCount": 1,
      "CacheHandler": null,
      "CancellationHandler": null,
      "Number": 8,
      "LineNumber": 17,
      "EventBinding": null,
      "IsEvent": false,
      "Hash": "9a01ead384189d82cdbc3fab1e38c197ae82d46762c19f70b828a59f348560a7",
      "BuilderVersion": null,
      "RelativeGoalPath": "\\CreateSummary.goal",
      "UserIntent": "Write formatted content combining a title and summary into a specific file path"
    }
  ],
  "SubGoals": [],
  "Description": "The AnalyzeFile goal processes a file by reading its content, generating a hash, checking for existing records in a database, and if the file is new, it retrieves additional information using a language model and updates the database accordingly. It also writes a summary to a specified location.",
  "Visibility": 0,
  "GoalFileName": "CreateSummary.goal",
  "PrFileName": "00. Goal.pr",
  "RelativeGoalPath": "\\CreateSummary.goal",
  "RelativeGoalFolderPath": "\\",
  "RelativePrPath": ".build\\CreateSummary\\AnalyzeFile\\00. Goal.pr",
  "RelativePrFolderPath": ".build\\CreateSummary\\AnalyzeFile",
  "RelativeAppStartupFolderPath": null,
  "BuilderVersion": "0.1.18.1",
  "GoalInfo": null,
  "Injections": [],
  "Signature": null,
  "Hash": "736114e75fb4ddd012246e1701bb2ac55bd05f3db784086872e5bd50957f60d3",
  "IncomingVariablesRequired": {
    "%file.path%": "The path of the file to be analyzed.",
    "%file.Hash%": "The hash value of the file content, generated after reading the file.",
    "%file.title%": "The title to be associated with the file in the database.",
    "%file.Name%": "The name of the file, used for writing the summary.",
    "%now%": "The current timestamp for updating the file record."
  },
  "DataSourceName": null,
  "IsSetup": false,
  "IsEvent": false
}